#----------------------------------------------------------------
# General simulation parameters

Continue previous simulation: 1
Number of spatial dimensions: 3
Number of time steps: 20000
Time step size: 0.005
Spectral radius of infinite time step: 0.50
Searched file name to trigger stop: STOP_SIM

Save results to VTK format: 1
Name prefix of saved VTK files: result
Increment in saving VTK files: 50
Start saving after time step: 1

Increment in saving restart files: 50
Convert BIN to VTK format: 0

Verbose: 1
Warning: 0
Debug: 0

#----------------------------------------------------------------
# Mesh data

# Load Purkinje network for the left-ventricle
Add mesh: pfib_cylinder {
   # Purkinje network is loaded as a 1D fiber mesh
   Set mesh as fibers: t

   Mesh file path: mesh/purkinje.vtu
   Add face: purkinje {
     End nodes face file path: mesh/purkinje_endnodes.txt
   }
   # We need to provide domains to specifiy properties for solving
   # the equation. For e.g., fluid density and viscosity should be
   # provided for fluid, material properties for solid, etc. For
   # electrophysiology, we need to provide information on whether
   # the individual cell is a pacemaker cell or a regular myocyte.
   # This domain information needs to provided here. 

   # The file below is an ASCII file with number of lines the same
   # as the number of elements. Each line will idenfity the domain
   # number.
   Domain file path: mesh/domain_purkinje.dat

   # If there is only one uniform domain, a constant value may be
   # provided as,
   # # Domain: 0. 

   # If there are many domains, a vtu file may also be provided
   # with an element-based variable "DOMAIN_ID"
   # # Domain file path: mesh/multiple-domains.vtu

   # Scaling factor for the mesh
   Mesh scale factor: 1.0
}

Add mesh: myocardium {
   Mesh file path: mesh/mesh-complete.mesh.vtu
   Add face: endo {
      Face file path: mesh/interface.vtp
   }
   Add face: epi { 
      Face file path: mesh/outside.vtp
   }
   Add face: start{
      Face file path: mesh/start.vtp
   }
   Add face: end {
      Face file path: mesh/end.vtp
   }
   Domain file path: mesh/domain_myocardium.dat
   Mesh scale factor: 1.0
}

Add projection: purkinje {
   Project from face: epi
   Projection tolerance: -1

}
#----------------------------------------------------------------
# Equations
Add equation: CEP {
   Coupled: 1

   # Parameters for the nonlinear (Newton) solver
   Min iterations: 1
   Max iterations: 3
   Tolerance: 1e-6

   # Domain 1 consists of regular conducting myocytes
   Domain: 1 {
      # We use tenTusscher-Panfilov model
      Electrophysiology model: TTP

      Myocardial zone: pfib

      # Isotropic conductivity
      Conductivity (iso): 1.12571
      Conductivity (ani): 0.82715
      # Time integrator
      ODE solver: RK
   }

   # Domain 2 comprises pacemaker cells which need
   # information on external stimulus
   Domain: 2 {
      # We use tenTusscher-Panfilov model
      Electrophysiology model: TTP

      Myocardial zone: pfib

      # Isotropic conductivity
      Conductivity (iso): 1.12571
      Conductivity (ani): 0.82715

      # Time integrator
      ODE solver: RK

      # Details of external stimulus
      Stimulus: Istim {
         Amplitude: -52.0
         Start time: 0.0
         Duration: 1
         Cycle length: 10000.0
      }
   }
   
   Domain: 3 {
      Electrophysiology model: TTP
      Myocardial zone: myocardium
      Conductivity (iso): 0.012571
      Conductivity (ani): 0.082715
      ODE solver: RK

   }

   # Output variables for visualization
   Output: Spatial {
      Action_potential: t
   }

   # Linear solver parameters
   LS type: GMRES
   {
      Max iterations:      100
      Tolerance:           1D-6
      Krylov space dimension: 50
   }
}

